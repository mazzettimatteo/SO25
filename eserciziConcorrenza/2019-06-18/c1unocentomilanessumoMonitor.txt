Esercizio c.1: passaggio di dati uno o centomila ma non nessuno.
Scrivere un monitor con due procedure entry:
put(T dato);
T get(void);
Esistono due tipi di processo: gli scrittori che chiamano put e i lettori che chiamano la get.
La put deve fare in modo che tutti i lettori in attesa, qualora ve ne siano, ricevano il dato passato come parametro. Se
non ci sono lettori in attesa la put deve attendere la prima chiamata della procedure entry get e trasferire il dato. Se ci
sono già scrittori in attesa, il nuovo scrittore si mette in coda (ordine FIFO).
La get quindi se c'è uno scrittore in attesa deve ritornare il dato del primo scrittore in attesa (e sbloccare lo scrittore),
altrimenti deve attendere la prossima chiamata della procedure entry put.
Domanda ulteriore: è possibile implementare il monitor con una sola variabile di condizione? Perché?

monitor 1_100k_0:

condition ok2put
condition ok2get
T val
int nReaders=0
int nReadersW=0
int nWriters=0



void put(T dato){
    nWriters++
    if(nReaders==0 || nWriters>1){  //attendo se nessuno vuole leggere o se non sono il primo scrittore
        ok2put.wait()
    }
    //qui posso sicuramente scrivere
    val=dato    
    while(nReadersWaiting>0){   //devo svegliare tutti i lettori in attesa
        ok2get.signal()
    }
    nWriters--
}

T get(){
    nReaders++
    if(nWriters>0){ //se c'è almeno uno scrittore lo sveglio
        ok2put.signal()
    }
    else{   //altrimenti attendo che ci sia uno scrittore
        nReadersW++
        ok2get.wait()
        nReadersW--
    }
    //qui sicuramente qualcuno ha scritto su val
    T result=val    
    nReaders--
    return val
}